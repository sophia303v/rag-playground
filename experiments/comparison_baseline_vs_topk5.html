<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Experiment Comparison</title>
<script src="https://cdn.plot.ly/plotly-2.35.0.min.js"></script>
<style>
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
         background: #f5f7fa; color: #1a1a2e; padding: 2rem; }
  .container { max-width: 1200px; margin: 0 auto; }
  h1 { font-size: 1.8rem; margin-bottom: 0.3rem; }
  .subtitle { color: #666; margin-bottom: 2rem; font-size: 0.95rem; }
  .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem; }
  .card { background: #fff; border-radius: 12px; padding: 1.5rem;
           box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
  .card h2 { font-size: 1.1rem; margin-bottom: 1rem; color: #16213e; }
  .full-width { grid-column: 1 / -1; }
  table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
  th { background: #16213e; color: #fff; padding: 0.6rem 0.5rem; text-align: left;
       position: sticky; top: 0; }
  td { padding: 0.5rem; border-bottom: 1px solid #e8e8e8; }
  tr:hover { background: #f0f4ff; }
  .score-cell { text-align: center; font-weight: 600; border-radius: 4px; }
  .score-high { background: #d4edda; color: #155724; }
  .score-mid { background: #fff3cd; color: #856404; }
  .score-low { background: #f8d7da; color: #721c24; }
  .score-na { background: #e2e3e5; color: #6c757d; }
  .delta-pos { color: #155724; font-weight: 600; }
  .delta-neg { color: #721c24; font-weight: 600; }
  .delta-zero { color: #6c757d; }
  .diff-cell { background: #fff8e1; font-weight: 600; }
  .detail-scroll { max-height: 500px; overflow-y: auto; }
  .legend { display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 1rem; }
  .legend-item { display: flex; align-items: center; gap: 0.3rem; font-size: 0.85rem; }
  .legend-dot { width: 12px; height: 12px; border-radius: 50%; }
</style>
</head>
<body>
<div class="container">
  <h1>Experiment Comparison</h1>
  <p class="subtitle">Comparing 2 experiments: Baseline (K=3), TOP_K=5</p>

  <!-- Legend -->
  <div class="legend">
    <div class="legend-item"><div class="legend-dot" style="background:#0f3460"></div>Baseline (K=3)</div><div class="legend-item"><div class="legend-dot" style="background:#e74c3c"></div>TOP_K=5</div>
  </div>

  <!-- Config diff -->
  <div class="card full-width" style="margin-bottom:1.5rem;">
    <h2>Configuration Differences</h2>
    <table><tr><th>Parameter</th><th>Baseline (K=3)</th><th>TOP_K=5</th></tr><tr><td><strong>TOP_K</strong></td><td class='diff-cell'>3</td><td class='diff-cell'>5</td></tr><tr><td><strong>VISION_BACKEND</strong></td><td class='diff-cell'>—</td><td class='diff-cell'>gemini</td></tr><tr><td><strong>OLLAMA_VISION_MODEL</strong></td><td class='diff-cell'>—</td><td class='diff-cell'>llava:7b</td></tr></table>
  </div>

  <!-- Metric summary -->
  <div class="card full-width" style="margin-bottom:1.5rem;">
    <h2>Metric Summary</h2>
    <table><tr><th>Metric</th><th>Baseline (K=3)</th><th>TOP_K=5</th><th>Delta</th></tr><tr><td>Ctx Precision</td><td class='score-cell score-low'>0.32</td><td class='score-cell score-low'>0.22</td><td class='delta-neg'>-0.105</td></tr><tr><td>Ctx Recall</td><td class='score-cell score-mid'>0.64</td><td class='score-cell score-mid'>0.69</td><td class='delta-pos'>+0.052</td></tr><tr><td>Faithfulness</td><td class='score-cell score-na'>N/A</td><td class='score-cell score-na'>N/A</td><td class='delta-zero'>—</td></tr><tr><td>Relevancy</td><td class='score-cell score-na'>N/A</td><td class='score-cell score-na'>N/A</td><td class='delta-zero'>—</td></tr><tr><td>Medical</td><td class='score-cell score-na'>N/A</td><td class='score-cell score-na'>N/A</td><td class='delta-zero'>—</td></tr><tr><td>Citation</td><td class='score-cell score-na'>N/A</td><td class='score-cell score-na'>N/A</td><td class='delta-zero'>—</td></tr><tr><td>Completeness</td><td class='score-cell score-na'>N/A</td><td class='score-cell score-na'>N/A</td><td class='delta-zero'>—</td></tr></table>
  </div>

  <!-- Charts row -->
  <div class="grid">
    <div class="card">
      <h2>Overall Metrics (Radar)</h2>
      <div id="radar-chart"></div>
    </div>
    <div class="card">
      <h2>Metrics Comparison (Bar)</h2>
      <div id="bar-chart"></div>
    </div>
  </div>

  <!-- Category comparison -->
  <div class="card full-width" style="margin-bottom:1.5rem;">
    <h2>Scores by Category</h2>
    <div id="cat-chart"></div>
  </div>

  <!-- Per-question delta table -->
  <div class="card full-width">
    <h2>Per-Question Score Changes</h2>
    <p style="color:#666; font-size:0.85rem; margin-bottom:0.8rem;">
      Delta = last experiment minus first experiment. Sorted by largest change.
    </p>
    <div class="detail-scroll">
    <table><tr><th>ID</th><th>Category</th><th>Baseline (K=3)<br>Ctx Precision</th><th>TOP_K=5<br>Ctx Precision</th><th>Delta</th><th>Baseline (K=3)<br>Ctx Recall</th><th>TOP_K=5<br>Ctx Recall</th><th>Delta</th></tr><tr><td>q34</td><td>diagnostic</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-low'>0.20</td><td class='delta-pos'>+0.200</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-high'>1.00</td><td class='delta-pos'>+1.000</td></tr><tr><td>q22</td><td>comparative</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-low'>0.20</td><td class='delta-pos'>+0.200</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-mid'>0.50</td><td class='delta-pos'>+0.500</td></tr><tr><td>q07</td><td>factual</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-low'>0.33</td><td class='delta-neg'>-0.667</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q23</td><td>comparative</td><td class='score-cell score-mid'>0.50</td><td class='score-cell score-mid'>0.67</td><td class='delta-pos'>+0.167</td><td class='score-cell score-low'>0.33</td><td class='score-cell score-mid'>0.67</td><td class='delta-pos'>+0.333</td></tr><tr><td>q29</td><td>comparative</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-low'>0.20</td><td class='delta-pos'>+0.200</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-low'>0.25</td><td class='delta-pos'>+0.250</td></tr><tr><td>q36</td><td>procedural</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-mid'>0.67</td><td class='delta-neg'>-0.333</td><td class='score-cell score-low'>0.33</td><td class='score-cell score-low'>0.33</td><td class='delta-zero'>0.000</td></tr><tr><td>q06</td><td>factual</td><td class='score-cell score-mid'>0.50</td><td class='score-cell score-low'>0.25</td><td class='delta-neg'>-0.250</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q10</td><td>factual</td><td class='score-cell score-mid'>0.50</td><td class='score-cell score-low'>0.25</td><td class='delta-neg'>-0.250</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q12</td><td>factual</td><td class='score-cell score-mid'>0.50</td><td class='score-cell score-low'>0.25</td><td class='delta-neg'>-0.250</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q19</td><td>factual</td><td class='score-cell score-mid'>0.50</td><td class='score-cell score-low'>0.25</td><td class='delta-neg'>-0.250</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q20</td><td>factual</td><td class='score-cell score-mid'>0.50</td><td class='score-cell score-low'>0.25</td><td class='delta-neg'>-0.250</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q39</td><td>procedural</td><td class='score-cell score-mid'>0.50</td><td class='score-cell score-low'>0.25</td><td class='delta-neg'>-0.250</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q15</td><td>factual</td><td class='score-cell score-mid'>0.50</td><td class='score-cell score-low'>0.33</td><td class='delta-neg'>-0.167</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q32</td><td>diagnostic</td><td class='score-cell score-mid'>0.50</td><td class='score-cell score-low'>0.33</td><td class='delta-neg'>-0.167</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q21</td><td>comparative</td><td class='score-cell score-mid'>0.67</td><td class='score-cell score-mid'>0.50</td><td class='delta-neg'>-0.167</td><td class='score-cell score-mid'>0.67</td><td class='score-cell score-mid'>0.67</td><td class='delta-zero'>0.000</td></tr><tr><td>q02</td><td>factual</td><td class='score-cell score-low'>0.33</td><td class='score-cell score-low'>0.20</td><td class='delta-neg'>-0.133</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q04</td><td>factual</td><td class='score-cell score-low'>0.33</td><td class='score-cell score-low'>0.20</td><td class='delta-neg'>-0.133</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q05</td><td>factual</td><td class='score-cell score-low'>0.33</td><td class='score-cell score-low'>0.20</td><td class='delta-neg'>-0.133</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q13</td><td>factual</td><td class='score-cell score-low'>0.33</td><td class='score-cell score-low'>0.20</td><td class='delta-neg'>-0.133</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q14</td><td>factual</td><td class='score-cell score-low'>0.33</td><td class='score-cell score-low'>0.20</td><td class='delta-neg'>-0.133</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q16</td><td>factual</td><td class='score-cell score-low'>0.33</td><td class='score-cell score-low'>0.20</td><td class='delta-neg'>-0.133</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q17</td><td>factual</td><td class='score-cell score-low'>0.33</td><td class='score-cell score-low'>0.20</td><td class='delta-neg'>-0.133</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q18</td><td>factual</td><td class='score-cell score-low'>0.33</td><td class='score-cell score-low'>0.20</td><td class='delta-neg'>-0.133</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q25</td><td>comparative</td><td class='score-cell score-low'>0.33</td><td class='score-cell score-low'>0.20</td><td class='delta-neg'>-0.133</td><td class='score-cell score-mid'>0.50</td><td class='score-cell score-mid'>0.50</td><td class='delta-zero'>0.000</td></tr><tr><td>q27</td><td>comparative</td><td class='score-cell score-low'>0.33</td><td class='score-cell score-low'>0.20</td><td class='delta-neg'>-0.133</td><td class='score-cell score-low'>0.33</td><td class='score-cell score-low'>0.33</td><td class='delta-zero'>0.000</td></tr><tr><td>q38</td><td>procedural</td><td class='score-cell score-low'>0.33</td><td class='score-cell score-low'>0.20</td><td class='delta-neg'>-0.133</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q11</td><td>factual</td><td class='score-cell score-low'>0.33</td><td class='score-cell score-low'>0.25</td><td class='delta-neg'>-0.083</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q24</td><td>comparative</td><td class='score-cell score-low'>0.33</td><td class='score-cell score-low'>0.25</td><td class='delta-neg'>-0.083</td><td class='score-cell score-mid'>0.50</td><td class='score-cell score-mid'>0.50</td><td class='delta-zero'>0.000</td></tr><tr><td>q31</td><td>diagnostic</td><td class='score-cell score-low'>0.33</td><td class='score-cell score-low'>0.25</td><td class='delta-neg'>-0.083</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q33</td><td>diagnostic</td><td class='score-cell score-low'>0.33</td><td class='score-cell score-low'>0.25</td><td class='delta-neg'>-0.083</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q35</td><td>diagnostic</td><td class='score-cell score-low'>0.33</td><td class='score-cell score-low'>0.25</td><td class='delta-neg'>-0.083</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q40</td><td>procedural</td><td class='score-cell score-low'>0.33</td><td class='score-cell score-low'>0.25</td><td class='delta-neg'>-0.083</td><td class='score-cell score-high'>1.00</td><td class='score-cell score-high'>1.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q01</td><td>factual</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-low'>0.00</td><td class='delta-zero'>0.000</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-low'>0.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q03</td><td>factual</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-low'>0.00</td><td class='delta-zero'>0.000</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-low'>0.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q08</td><td>factual</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-low'>0.00</td><td class='delta-zero'>0.000</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-low'>0.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q09</td><td>factual</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-low'>0.00</td><td class='delta-zero'>0.000</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-low'>0.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q26</td><td>comparative</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-low'>0.00</td><td class='delta-zero'>0.000</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-low'>0.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q28</td><td>comparative</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-low'>0.00</td><td class='delta-zero'>0.000</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-low'>0.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q30</td><td>comparative</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-low'>0.00</td><td class='delta-zero'>0.000</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-low'>0.00</td><td class='delta-zero'>0.000</td></tr><tr><td>q37</td><td>procedural</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-low'>0.00</td><td class='delta-zero'>0.000</td><td class='score-cell score-low'>0.00</td><td class='score-cell score-low'>0.00</td><td class='delta-zero'>0.000</td></tr></table>
    </div>
  </div>
</div>

<script>

Plotly.newPlot('radar-chart', [{"type": "scatterpolar", "r": [0.3208, 0.6417, 0, 0, 0, 0, 0, 0.3208], "theta": ["Ctx Precision", "Ctx Recall", "Faithfulness", "Relevancy", "Medical", "Citation", "Completeness", "Ctx Precision"], "fill": "toself", "fillcolor": "rgba(15,52,96,0.08)", "name": "Baseline (K=3)", "line": {"color": "#0f3460", "width": 2}, "marker": {"size": 5, "color": "#0f3460"}}, {"type": "scatterpolar", "r": [0.2158, 0.6937, 0, 0, 0, 0, 0, 0.2158], "theta": ["Ctx Precision", "Ctx Recall", "Faithfulness", "Relevancy", "Medical", "Citation", "Completeness", "Ctx Precision"], "fill": "toself", "fillcolor": "rgba(231,76,60,0.08)", "name": "TOP_K=5", "line": {"color": "#e74c3c", "width": 2}, "marker": {"size": 5, "color": "#e74c3c"}}], {
  polar: {
    radialaxis: { visible: true, range: [0, 1], tickvals: [0.2, 0.4, 0.6, 0.8, 1.0] }
  },
  margin: { t: 30, b: 30, l: 60, r: 60 },
  height: 380,
  legend: { orientation: 'h', y: -0.15, x: 0.5, xanchor: 'center' }
}, { responsive: true });


Plotly.newPlot('bar-chart', [{"x": ["Ctx Precision", "Ctx Recall", "Faithfulness", "Relevancy", "Medical", "Citation", "Completeness"], "y": [0.3208, 0.6417, 0, 0, 0, 0, 0], "name": "Baseline (K=3)", "type": "bar", "marker": {"color": "#0f3460"}}, {"x": ["Ctx Precision", "Ctx Recall", "Faithfulness", "Relevancy", "Medical", "Citation", "Completeness"], "y": [0.2158, 0.6937, 0, 0, 0, 0, 0], "name": "TOP_K=5", "type": "bar", "marker": {"color": "#e74c3c"}}], {
  barmode: 'group',
  yaxis: { range: [0, 1], title: 'Score' },
  margin: { t: 30, b: 80, l: 50, r: 20 },
  height: 380,
  legend: { orientation: 'h', y: -0.3, x: 0.5, xanchor: 'center' }
}, { responsive: true });


Plotly.newPlot('cat-chart', [{"x": ["comparative", "diagnostic", "factual", "procedural"], "y": [0.2167, 0.3, 0.35, 0.4333], "name": "Baseline (K=3) \u2014 Ctx Precision", "type": "bar", "marker": {"color": "#0f3460", "opacity": 1.0}}, {"x": ["comparative", "diagnostic", "factual", "procedural"], "y": [0.2333, 0.8, 0.8, 0.6667], "name": "Baseline (K=3) \u2014 Ctx Recall", "type": "bar", "marker": {"color": "#0f3460", "opacity": 0.5}}, {"x": ["comparative", "diagnostic", "factual", "procedural"], "y": [0.2217, 0.2567, 0.1883, 0.2733], "name": "TOP_K=5 \u2014 Ctx Precision", "type": "bar", "marker": {"color": "#e74c3c", "opacity": 1.0}}, {"x": ["comparative", "diagnostic", "factual", "procedural"], "y": [0.3417, 1.0, 0.8, 0.6667], "name": "TOP_K=5 \u2014 Ctx Recall", "type": "bar", "marker": {"color": "#e74c3c", "opacity": 0.5}}], {
  barmode: 'group',
  yaxis: { range: [0, 1], title: 'Score' },
  xaxis: { title: 'Category' },
  margin: { t: 30, b: 60, l: 50, r: 20 },
  height: 350,
  legend: { orientation: 'h', y: -0.25, x: 0.5, xanchor: 'center', font: { size: 10 } }
}, { responsive: true });

</script>
</body>
</html>